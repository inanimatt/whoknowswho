CREATE TABLE contact_messages (id BIGINT AUTO_INCREMENT, message_type VARCHAR(32), name VARCHAR(32) NOT NULL, email VARCHAR(255) NOT NULL, message TEXT NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE disambiguation (id INT AUTO_INCREMENT, title VARCHAR(255) NOT NULL, created_by INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE disambiguation_entity (disambiguation_id INT, entity_id BIGINT, PRIMARY KEY(disambiguation_id, entity_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE entity_version (id BIGINT, entity_type_id INT NOT NULL, is_locked TINYINT DEFAULT '0' NOT NULL, superceded_by_id BIGINT, authority_id BIGINT, created_by INT, name VARCHAR(255) NOT NULL, subtitle VARCHAR(255), version_comment VARCHAR(255), description TEXT, photo_url VARCHAR(255), photo_caption VARCHAR(255), photo_licence VARCHAR(255), created_at DATETIME, updated_at DATETIME, views BIGINT DEFAULT 0 NOT NULL, slug VARCHAR(255), version BIGINT, PRIMARY KEY(id, version)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE entity_index (id BIGINT, keyword VARCHAR(200), field VARCHAR(50), position BIGINT, PRIMARY KEY(id, keyword, field, position)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE entity (id BIGINT AUTO_INCREMENT, entity_type_id INT NOT NULL, is_locked TINYINT DEFAULT '0' NOT NULL, superceded_by_id BIGINT, authority_id BIGINT, created_by INT, name VARCHAR(255) NOT NULL, subtitle VARCHAR(255), version_comment VARCHAR(255), description TEXT, photo_url VARCHAR(255), photo_caption VARCHAR(255), photo_licence VARCHAR(255), created_at DATETIME, updated_at DATETIME, views BIGINT DEFAULT 0 NOT NULL, slug VARCHAR(255), version BIGINT, UNIQUE INDEX slug_idx (slug), INDEX superceded_by_id_idx (superceded_by_id), INDEX created_by_idx (created_by), INDEX authority_id_idx (authority_id), INDEX entity_type_id_idx (entity_type_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE entity_action_required (entity_id BIGINT, needs_external_links TINYINT, needs_wiki_page TINYINT, needs_description TINYINT, needs_facts TINYINT, needs_subtitle TINYINT, PRIMARY KEY(entity_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE entity_alias_index (id BIGINT, keyword VARCHAR(200), field VARCHAR(50), position BIGINT, PRIMARY KEY(id, keyword, field, position)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE entity_alias (id BIGINT AUTO_INCREMENT, entity_id BIGINT NOT NULL, name VARCHAR(255) NOT NULL, created_by INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX created_by_idx (created_by), INDEX entity_id_idx (entity_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE entity_creation_queue (id BIGINT AUTO_INCREMENT, entity_id BIGINT, mp_info VARCHAR(255) DEFAULT 'pending' NOT NULL, person VARCHAR(255) DEFAULT 'pending' NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX entity_id_idx (entity_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE entity_type (id INT AUTO_INCREMENT, title VARCHAR(255) NOT NULL, url_slug VARCHAR(32) NOT NULL, description TEXT NOT NULL, UNIQUE INDEX slug_idx_idx (url_slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE entity_url (id BIGINT AUTO_INCREMENT, entity_id BIGINT NOT NULL, url TEXT NOT NULL, title TEXT, urltype VARCHAR(64), created_by INT, foreign_id VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX equiv_idx (urltype, foreign_id), INDEX created_by_idx (created_by), INDEX entity_id_idx (entity_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE entity_url_verified (id BIGINT AUTO_INCREMENT, entity_url_id BIGINT NOT NULL, score SMALLINT DEFAULT '0' NOT NULL, created_by INT NOT NULL, comment VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX created_by_idx (created_by), INDEX entity_url_id_idx (entity_url_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE fact (id BIGINT AUTO_INCREMENT, entity_id BIGINT NOT NULL, title VARCHAR(255) NOT NULL, description TEXT NOT NULL, related_entity_id BIGINT, start DATE, end DATE, created_by INT, fact_type_id INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX created_by_idx (created_by), INDEX entity_id_idx (entity_id), INDEX related_entity_id_idx (related_entity_id), INDEX fact_type_id_idx (fact_type_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE fact_action_required (fact_id BIGINT, needs_sources TINYINT, needs_description TINYINT, PRIMARY KEY(fact_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE fact_comment (id BIGINT AUTO_INCREMENT, fact_id BIGINT NOT NULL, fact_score SMALLINT DEFAULT '0' NOT NULL, comment_score SMALLINT DEFAULT '0' NOT NULL, created_by INT NOT NULL, comment TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX created_by_idx (created_by), INDEX fact_id_idx (fact_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE fact_source (id BIGINT AUTO_INCREMENT, fact_id BIGINT NOT NULL, url TEXT NOT NULL, source_type_id INT NOT NULL, is_supporting TINYINT DEFAULT '1', title VARCHAR(255), created_by INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX source_type_id_idx (source_type_id), INDEX fact_id_idx (fact_id), INDEX created_by_idx (created_by), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE fact_source_verified (id BIGINT AUTO_INCREMENT, fact_source_id BIGINT NOT NULL, score SMALLINT DEFAULT '0' NOT NULL, created_by INT NOT NULL, comment VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX created_by_idx (created_by), INDEX fact_source_id_idx (fact_source_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE fact_type (id INT AUTO_INCREMENT, type VARCHAR(255) NOT NULL, description TEXT, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE source_type (id INT AUTO_INCREMENT, type VARCHAR(255) NOT NULL, description TEXT, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE story_version (id BIGINT, story_type_id INT NOT NULL, is_public TINYINT DEFAULT '0' NOT NULL, created_by INT NOT NULL, title VARCHAR(255) NOT NULL, subtitle VARCHAR(255), version_comment VARCHAR(255), description TEXT, photo_url VARCHAR(255), photo_caption VARCHAR(255), photo_licence VARCHAR(255), teaser TEXT, created_at DATETIME, updated_at DATETIME, views BIGINT DEFAULT 0 NOT NULL, slug VARCHAR(255), version BIGINT, PRIMARY KEY(id, version)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE story_index (id BIGINT, keyword VARCHAR(200), field VARCHAR(50), position BIGINT, PRIMARY KEY(id, keyword, field, position)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE story (id BIGINT AUTO_INCREMENT, story_type_id INT NOT NULL, is_public TINYINT DEFAULT '0' NOT NULL, created_by INT NOT NULL, title VARCHAR(255) NOT NULL, subtitle VARCHAR(255), version_comment VARCHAR(255), description TEXT, photo_url VARCHAR(255), photo_caption VARCHAR(255), photo_licence VARCHAR(255), teaser TEXT, created_at DATETIME, updated_at DATETIME, views BIGINT DEFAULT 0 NOT NULL, slug VARCHAR(255), version BIGINT, UNIQUE INDEX slug_idx (slug), INDEX story_type_id_idx (story_type_id), INDEX created_by_idx (created_by), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE story_comment (id BIGINT AUTO_INCREMENT, story_id BIGINT NOT NULL, created_by INT, confirmation_token VARCHAR(8) DEFAULT '0' NOT NULL, email_confirmed TINYINT DEFAULT '0' NOT NULL, comment_approved TINYINT DEFAULT '0' NOT NULL, story_version BIGINT, comment TEXT, email VARCHAR(255), username VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX created_by_idx (created_by), INDEX story_id_idx (story_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE story_fact (story_id BIGINT, fact_id BIGINT, primary_entity VARCHAR(255), story_order BIGINT, description VARCHAR(255), PRIMARY KEY(story_id, fact_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE story_rating (story_id BIGINT, 1_votes BIGINT DEFAULT 0 NOT NULL, 2_votes BIGINT DEFAULT 0 NOT NULL, 3_votes BIGINT DEFAULT 0 NOT NULL, 4_votes BIGINT DEFAULT 0 NOT NULL, 5_votes BIGINT DEFAULT 0 NOT NULL, average_vote DOUBLE DEFAULT 0 NOT NULL, PRIMARY KEY(story_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE story_relation (story_id BIGINT, related_story_id BIGINT, PRIMARY KEY(story_id, related_story_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE story_type (id INT AUTO_INCREMENT, type VARCHAR(255) NOT NULL, description TEXT, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE sf_guard_group (id INT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_group_permission (group_id INT, permission_id INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(group_id, permission_id)) ENGINE = INNODB;
CREATE TABLE sf_guard_permission (id INT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_remember_key (id INT AUTO_INCREMENT, user_id INT, remember_key VARCHAR(32), ip_address VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id, ip_address)) ENGINE = INNODB;
CREATE TABLE sf_guard_user (id INT AUTO_INCREMENT, username VARCHAR(128) NOT NULL UNIQUE, algorithm VARCHAR(128) DEFAULT 'sha1' NOT NULL, salt VARCHAR(128), password VARCHAR(128), is_active TINYINT(1) DEFAULT '1', is_super_admin TINYINT(1) DEFAULT '0', last_login DATETIME, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX is_active_idx_idx (is_active), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user_group (user_id INT, group_id INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, group_id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user_permission (user_id INT, permission_id INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, permission_id)) ENGINE = INNODB;
ALTER TABLE disambiguation_entity ADD CONSTRAINT disambiguation_entity_entity_id_entity_id FOREIGN KEY (entity_id) REFERENCES entity(id) ON DELETE CASCADE;
ALTER TABLE disambiguation_entity ADD CONSTRAINT disambiguation_entity_disambiguation_id_disambiguation_id FOREIGN KEY (disambiguation_id) REFERENCES disambiguation(id) ON DELETE CASCADE;
ALTER TABLE entity_version ADD CONSTRAINT entity_version_id_entity_id FOREIGN KEY (id) REFERENCES entity(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE entity_index ADD CONSTRAINT entity_index_id_entity_id FOREIGN KEY (id) REFERENCES entity(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE entity ADD CONSTRAINT entity_superceded_by_id_entity_id FOREIGN KEY (superceded_by_id) REFERENCES entity(id) ON DELETE SET NULL;
ALTER TABLE entity ADD CONSTRAINT entity_entity_type_id_entity_type_id FOREIGN KEY (entity_type_id) REFERENCES entity_type(id) ON DELETE CASCADE;
ALTER TABLE entity ADD CONSTRAINT entity_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id) ON DELETE SET NULL;
ALTER TABLE entity ADD CONSTRAINT entity_authority_id_entity_id FOREIGN KEY (authority_id) REFERENCES entity(id) ON DELETE SET NULL;
ALTER TABLE entity_alias_index ADD CONSTRAINT entity_alias_index_id_entity_alias_id FOREIGN KEY (id) REFERENCES entity_alias(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE entity_alias ADD CONSTRAINT entity_alias_entity_id_entity_id FOREIGN KEY (entity_id) REFERENCES entity(id) ON DELETE CASCADE;
ALTER TABLE entity_alias ADD CONSTRAINT entity_alias_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id) ON DELETE SET NULL;
ALTER TABLE entity_creation_queue ADD CONSTRAINT entity_creation_queue_entity_id_entity_id FOREIGN KEY (entity_id) REFERENCES entity(id) ON DELETE CASCADE;
ALTER TABLE entity_url ADD CONSTRAINT entity_url_entity_id_entity_id FOREIGN KEY (entity_id) REFERENCES entity(id) ON DELETE CASCADE;
ALTER TABLE entity_url ADD CONSTRAINT entity_url_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id) ON DELETE SET NULL;
ALTER TABLE entity_url_verified ADD CONSTRAINT entity_url_verified_entity_url_id_entity_url_id FOREIGN KEY (entity_url_id) REFERENCES entity_url(id) ON DELETE CASCADE;
ALTER TABLE entity_url_verified ADD CONSTRAINT entity_url_verified_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE fact ADD CONSTRAINT fact_related_entity_id_entity_id FOREIGN KEY (related_entity_id) REFERENCES entity(id) ON DELETE SET NULL;
ALTER TABLE fact ADD CONSTRAINT fact_fact_type_id_fact_type_id FOREIGN KEY (fact_type_id) REFERENCES fact_type(id) ON DELETE CASCADE;
ALTER TABLE fact ADD CONSTRAINT fact_entity_id_entity_id FOREIGN KEY (entity_id) REFERENCES entity(id) ON DELETE CASCADE;
ALTER TABLE fact ADD CONSTRAINT fact_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id) ON DELETE SET NULL;
ALTER TABLE fact_comment ADD CONSTRAINT fact_comment_fact_id_fact_id FOREIGN KEY (fact_id) REFERENCES fact(id) ON DELETE CASCADE;
ALTER TABLE fact_comment ADD CONSTRAINT fact_comment_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE fact_source ADD CONSTRAINT fact_source_source_type_id_source_type_id FOREIGN KEY (source_type_id) REFERENCES source_type(id) ON DELETE CASCADE;
ALTER TABLE fact_source ADD CONSTRAINT fact_source_fact_id_fact_id FOREIGN KEY (fact_id) REFERENCES fact(id) ON DELETE CASCADE;
ALTER TABLE fact_source ADD CONSTRAINT fact_source_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id) ON DELETE SET NULL;
ALTER TABLE fact_source_verified ADD CONSTRAINT fact_source_verified_fact_source_id_fact_source_id FOREIGN KEY (fact_source_id) REFERENCES fact_source(id) ON DELETE CASCADE;
ALTER TABLE fact_source_verified ADD CONSTRAINT fact_source_verified_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE story_version ADD CONSTRAINT story_version_id_story_id FOREIGN KEY (id) REFERENCES story(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE story_index ADD CONSTRAINT story_index_id_story_id FOREIGN KEY (id) REFERENCES story(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE story ADD CONSTRAINT story_story_type_id_story_type_id FOREIGN KEY (story_type_id) REFERENCES story_type(id) ON DELETE CASCADE;
ALTER TABLE story ADD CONSTRAINT story_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE story_comment ADD CONSTRAINT story_comment_story_id_story_id FOREIGN KEY (story_id) REFERENCES story(id) ON DELETE CASCADE;
ALTER TABLE story_comment ADD CONSTRAINT story_comment_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE story_fact ADD CONSTRAINT story_fact_story_id_story_id FOREIGN KEY (story_id) REFERENCES story(id) ON DELETE CASCADE;
ALTER TABLE story_fact ADD CONSTRAINT story_fact_fact_id_fact_id FOREIGN KEY (fact_id) REFERENCES fact(id) ON DELETE CASCADE;
ALTER TABLE story_relation ADD CONSTRAINT story_relation_story_id_story_id FOREIGN KEY (story_id) REFERENCES story(id) ON DELETE CASCADE;
ALTER TABLE story_relation ADD CONSTRAINT story_relation_related_story_id_story_id FOREIGN KEY (related_story_id) REFERENCES story(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_remember_key ADD CONSTRAINT sf_guard_remember_key_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
